{"ast":null,"code":"import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nconst initialState = {\n  frends: [],\n  loading: false,\n  hasError: null\n};\nexport const FrendsSlice = createSlice({\n  name: 'frends',\n  initialState,\n  reducers: {\n    getFrends: (state, action) => {\n      state.frends.push(action.payload);\n      state.frends.find(item => item.id !== action.payload.id);\n    },\n    filterFrends: (state, action) => {\n      const itemId = state.frends.findIndex(item => item.id === action.payload.id);\n      state.frends.splice(itemId, 1);\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(FetchFrendsAll.pending, state => {\n      state.loading = true;\n      state.hasError = null;\n    }).addCase(FetchFrendsAll.fulfilled, (state, action) => {\n      state.loading = false;\n      state.frends = action.payload;\n    }).addCase(FetchFrendsAll.rejected, (state, action) => {\n      state.loading = false;\n    }).addMatcher(isError, (state, action) => {\n      state.loading = false;\n      state.hasError = action.payload;\n    });\n  }\n});\nfunction isError(action) {\n  return action.type.endsWith('rejected');\n}\nexport const FetchFrendsAll = createAsyncThunk('frends/FetchFrends', async function (_, _ref) {\n  let {\n    rejectWithValue\n  } = _ref;\n  const response = await fetch('/frends');\n  if (!response.ok) {\n    return rejectWithValue('Ошибка на сервере');\n  }\n  const data = await response.json();\n  return data;\n});\nexport const {\n  getFrends,\n  filterFrends\n} = FrendsSlice.actions;\nexport const frendsSelector = state => state.frends;\nexport default FrendsSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","initialState","frends","loading","hasError","FrendsSlice","name","reducers","getFrends","state","action","push","payload","find","item","id","filterFrends","itemId","findIndex","splice","extraReducers","builder","addCase","FetchFrendsAll","pending","fulfilled","rejected","addMatcher","isError","type","endsWith","_","_ref","rejectWithValue","response","fetch","ok","data","json","actions","frendsSelector","reducer"],"sources":["C:/Users/DmitriyV/project/VKProject/my-chat/src/redux/features/FrendsList/FrendsSlice.tsx"],"sourcesContent":["import { AnyAction, createAsyncThunk, createSlice, PayloadAction} from '@reduxjs/toolkit';\r\n\r\n\r\ntype Frends={\r\n    id:number;\r\nname:string;\r\nimg:string;\r\nalt:string;\r\n}\r\ninterface FrendsState {\r\n    frends:Frends[],\r\n    loading:boolean;\r\n    hasError:null|string;\r\n}\r\nconst initialState: FrendsState={\r\n    frends:[],\r\n    loading:false,\r\n    hasError:null\r\n}\r\nexport const FrendsSlice=createSlice({\r\n    name:'frends',\r\n    initialState,\r\n    reducers:{\r\n        getFrends:(state, action:PayloadAction<Frends>)=>{\r\n         state.frends.push(action.payload)\r\n           state.frends.find((item)=>item.id!==action.payload.id)\r\n        \r\n           \r\n        },\r\n        filterFrends:(state, action:PayloadAction<Frends>)=>{\r\n            const itemId=state.frends.findIndex((item)=>item.id===action.payload.id);\r\n            state.frends.splice(itemId, 1)\r\n        }\r\n      \r\n    },\r\n    extraReducers: (builder)=>{\r\n        builder\r\n      .addCase(FetchFrendsAll.pending, (state)=>{\r\n            state.loading=true;\r\n            state.hasError=null;\r\n\r\n        })\r\n       .addCase(FetchFrendsAll.fulfilled, (state, action)=>{\r\n            state.loading=false;\r\n            state.frends=action.payload;\r\n\r\n        })\r\n       .addCase(FetchFrendsAll.rejected, (state, action)=>{\r\n            state.loading=false\r\n\r\n        })\r\n        .addMatcher(isError, (state, action:PayloadAction<string>)=>{\r\n            state.loading=false;\r\n            state.hasError=action.payload\r\n\r\n        })\r\n\r\n    }\r\n})\r\nfunction isError(action: AnyAction){\r\nreturn action.type.endsWith('rejected')\r\n}\r\n\r\nexport const FetchFrendsAll=createAsyncThunk<Frends[], undefined, {rejectValue:string}>(\r\n    'frends/FetchFrends',\r\n    async function (_, {rejectWithValue}) {\r\n        const response =await fetch ('/frends');\r\n        if(!response.ok){\r\n            return rejectWithValue('Ошибка на сервере')\r\n        }\r\n        const data=await response.json();\r\n        return data;\r\n    }\r\n) \r\n\r\nexport const {getFrends, filterFrends}=FrendsSlice.actions;\r\nexport const frendsSelector=(state:FrendsState)=>state.frends;\r\nexport default FrendsSlice.reducer;"],"mappings":"AAAA,SAAoBA,gBAAgB,EAAEC,WAAW,QAAsB,kBAAkB;AAczF,MAAMC,YAAyB,GAAC;EAC5BC,MAAM,EAAC,EAAE;EACTC,OAAO,EAAC,KAAK;EACbC,QAAQ,EAAC;AACb,CAAC;AACD,OAAO,MAAMC,WAAW,GAACL,WAAW,CAAC;EACjCM,IAAI,EAAC,QAAQ;EACbL,YAAY;EACZM,QAAQ,EAAC;IACLC,SAAS,EAACA,CAACC,KAAK,EAAEC,MAA4B,KAAG;MAChDD,KAAK,CAACP,MAAM,CAACS,IAAI,CAACD,MAAM,CAACE,OAAO,CAAC;MAC/BH,KAAK,CAACP,MAAM,CAACW,IAAI,CAAEC,IAAI,IAAGA,IAAI,CAACC,EAAE,KAAGL,MAAM,CAACE,OAAO,CAACG,EAAE,CAAC;IAGzD,CAAC;IACDC,YAAY,EAACA,CAACP,KAAK,EAAEC,MAA4B,KAAG;MAChD,MAAMO,MAAM,GAACR,KAAK,CAACP,MAAM,CAACgB,SAAS,CAAEJ,IAAI,IAAGA,IAAI,CAACC,EAAE,KAAGL,MAAM,CAACE,OAAO,CAACG,EAAE,CAAC;MACxEN,KAAK,CAACP,MAAM,CAACiB,MAAM,CAACF,MAAM,EAAE,CAAC,CAAC;IAClC;EAEJ,CAAC;EACDG,aAAa,EAAGC,OAAO,IAAG;IACtBA,OAAO,CACRC,OAAO,CAACC,cAAc,CAACC,OAAO,EAAGf,KAAK,IAAG;MACpCA,KAAK,CAACN,OAAO,GAAC,IAAI;MAClBM,KAAK,CAACL,QAAQ,GAAC,IAAI;IAEvB,CAAC,CAAC,CACFkB,OAAO,CAACC,cAAc,CAACE,SAAS,EAAE,CAAChB,KAAK,EAAEC,MAAM,KAAG;MAC/CD,KAAK,CAACN,OAAO,GAAC,KAAK;MACnBM,KAAK,CAACP,MAAM,GAACQ,MAAM,CAACE,OAAO;IAE/B,CAAC,CAAC,CACFU,OAAO,CAACC,cAAc,CAACG,QAAQ,EAAE,CAACjB,KAAK,EAAEC,MAAM,KAAG;MAC9CD,KAAK,CAACN,OAAO,GAAC,KAAK;IAEvB,CAAC,CAAC,CACDwB,UAAU,CAACC,OAAO,EAAE,CAACnB,KAAK,EAAEC,MAA4B,KAAG;MACxDD,KAAK,CAACN,OAAO,GAAC,KAAK;MACnBM,KAAK,CAACL,QAAQ,GAACM,MAAM,CAACE,OAAO;IAEjC,CAAC,CAAC;EAEN;AACJ,CAAC,CAAC;AACF,SAASgB,OAAOA,CAAClB,MAAiB,EAAC;EACnC,OAAOA,MAAM,CAACmB,IAAI,CAACC,QAAQ,CAAC,UAAU,CAAC;AACvC;AAEA,OAAO,MAAMP,cAAc,GAACxB,gBAAgB,CACxC,oBAAoB,EACpB,gBAAgBgC,CAAC,EAAAC,IAAA,EAAqB;EAAA,IAAnB;IAACC;EAAe,CAAC,GAAAD,IAAA;EAChC,MAAME,QAAQ,GAAE,MAAMC,KAAK,CAAE,SAAS,CAAC;EACvC,IAAG,CAACD,QAAQ,CAACE,EAAE,EAAC;IACZ,OAAOH,eAAe,CAAC,mBAAmB,CAAC;EAC/C;EACA,MAAMI,IAAI,GAAC,MAAMH,QAAQ,CAACI,IAAI,CAAC,CAAC;EAChC,OAAOD,IAAI;AACf,CACJ,CAAC;AAED,OAAO,MAAM;EAAC7B,SAAS;EAAEQ;AAAY,CAAC,GAACX,WAAW,CAACkC,OAAO;AAC1D,OAAO,MAAMC,cAAc,GAAE/B,KAAiB,IAAGA,KAAK,CAACP,MAAM;AAC7D,eAAeG,WAAW,CAACoC,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}